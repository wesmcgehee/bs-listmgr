/*
 *
 * Wijmo Library 1.2.0
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * licensing@wijmo.com
 * http://www.wijmo.com/license
 *
 **/
(function(a){"use strict";a.widget("wijmo.wijslider",a.ui.slider,{options:{buttonmouseover:null,buttonmouseout:null,buttonmousedown:null,buttonmouseup:null,buttonclick:null,dragFill:true},_setOption:function(b,a){this.options[b]=a;return this},_create:function(){var d,b,c,q,r,h,g,l,k,o,n,m,u,v,s,t,i,p,e,f,j;if(this.element.is(":input")){i=a("<div></div>");i.width(this.element.width());i.appendTo(document.body);p=this.element.val();if(p!=="")try{e=p.split(";");if(e.length>0){j=[];for(f=0;f<e.length;f++)j[f]=parseInt(e[f]);if(e.length==1)this.options.value=j[0];else this.options.values=j}}catch(w){}this.element.data(this.widgetName,i.wijslider(this.options));this.element.after(a(document.body).children("div:last"));this.element.css("display","none");return}a.ui.slider.prototype._create.apply(this,arguments);this.element.data("originalStyle",this.element.attr("style"));this.element.data("originalContent",this.element.html());d=this.element.width();b=this.element.height();c=a("<div></div>");if(this.options.orientation==="horizontal")c.addClass("wijmo-wijslider-horizontal");else c.addClass("wijmo-wijslider-vertical");c.width(d);c.height(b);q=a('<a class="wijmo-wijslider-decbutton"><span></span></a>');r=a('<a class="wijmo-wijslider-incbutton"><span></span></a>');this.element.wrap(c);this.element.before(q);this.element.after(r);this._attachClass();h=this._getDecreBtn().outerWidth();g=this._getDecreBtn().outerHeight();l=this._getIncreBtn().outerWidth();k=this._getIncreBtn().outerHeight();o=this.element.find(".ui-slider-handle");n=o.outerWidth();m=o.outerHeight();this.element.removeAttr("style");if(this.options.orientation==="horizontal"){u=b/2-g/2;this._getDecreBtn().css("top",u).css("left",0);v=b/2-k/2;this._getIncreBtn().css("top",v).css("right",0);this.element.css("left",h+n/2-1).css("top",b/2-this.element.outerHeight()/2).width(d-h-l-n-2)}else{s=d/2-h/2;this._getDecreBtn().css("left",s).css("top",0);t=d/2-l/2;this._getIncreBtn().css("left",t).css("bottom",0);this.element.css("left",d/2-this.element.outerWidth()/2).css("top",g+m/2+1).height(b-g-k-m-2)}this._bindEvents()},destroy:function(){var d=this,b,c;b=this._getDecreBtn();c=this._getIncreBtn();b.unbind("."+d.widgetName);c.unbind("."+d.widgetName);a.ui.slider.prototype.destroy.apply(this,arguments);this.element.parent().removeAttr("class");this.element.parent().html("")},_getDecreBtn:function(){return this.element.parent().find(".wijmo-wijslider-decbutton")},_getIncreBtn:function(){return this.element.parent().find(".wijmo-wijslider-incbutton")},_attachClass:function(){this._getDecreBtn().addClass("ui-corner-all ui-state-default").attr("role","button");this._getIncreBtn().addClass("ui-corner-all ui-state-default").attr("role","button");this.element.parent().attr("role","slider").attr("aria-valuemin",this.options.min).attr("aria-valuenow","0").attr("aria-valuemax",this.options.max);if(this.options.orientation==="horizontal"){this.element.parent().addClass("wijmo-wijslider-horizontal");this._getDecreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-w");this._getIncreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-e")}else{this.element.parent().addClass("wijmo-wijslider-vertical");this._getDecreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-n");this._getIncreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-s")}},_bindEvents:function(){var a=this,b,c;b=this._getDecreBtn();c=this._getIncreBtn();b.bind("click."+a.widgetName,a,a._decreBtnClick);c.bind("click."+a.widgetName,a,a._increBtnClick);b.bind("mouseover."+a.widgetName,a,a._decreBtnMouseOver);b.bind("mouseout."+a.widgetName,a,a._decreBtnMouseOut);b.bind("mousedown."+a.widgetName,a,a._decreBtnMouseDown);b.bind("mouseup."+a.widgetName,a,a._decreBtnMouseUp);c.bind("mouseover."+a.widgetName,a,a._increBtnMouseOver);c.bind("mouseout."+a.widgetName,a,a._increBtnMouseOut);c.bind("mousedown."+a.widgetName,a,a._increBtnMouseDown);c.bind("mouseup."+a.widgetName,a,a._increBtnMouseUp)},_decreBtnMouseOver:function(d){var c=d.data,b,a;b={buttonType:"decreButton"};c._trigger("buttonmouseover",d,b);a=c._getDecreBtn();a.addClass("ui-state-hover")},_increBtnMouseOver:function(d){var c=d.data,b,a;b={buttonType:"increButton"};c._trigger("buttonmouseover",d,b);a=c._getIncreBtn();a.addClass("ui-state-hover")},_decreBtnMouseOut:function(d){var c=d.data,b,a;b={buttonType:"decreButton"};c._trigger("buttonmouseout",d,b);a=c._getDecreBtn();a.removeClass("ui-state-hover ui-state-active")},_increBtnMouseOut:function(d){var c=d.data,b,a;b={buttonType:"increButton"};c._trigger("buttonmouseout",d,b);a=c._getIncreBtn();a.removeClass("ui-state-hover ui-state-active")},_decreBtnMouseDown:function(d){var a=d.data,c,b;c={buttonType:"decreButton"};a._trigger("buttonmousedown",d,c);b=a._getDecreBtn();b.addClass("ui-state-active");a._intervalID=window.setInterval(function(){a._decreBtnHandle(a)},200)},_intervalID:null,_increBtnMouseDown:function(d){var a=d.data,c,b;c={buttonType:"increButton"};a._trigger("buttonmousedown",d,c);b=a._getIncreBtn();b.addClass("ui-state-active");a._intervalID=window.setInterval(function(){a._increBtnHandle(a)},200)},_decreBtnMouseUp:function(d){var a=d.data,c,b;c={buttonType:"decreButton"};a._trigger("buttonmouseup",d,c);b=a._getDecreBtn();b.removeClass("ui-state-active");window.clearInterval(a._intervalID)},_increBtnMouseUp:function(d){var a=d.data,c,b;c={buttonType:"increButton"};a._trigger("buttonmouseup",d,c);b=a._getIncreBtn();b.removeClass("ui-state-active");window.clearInterval(a._intervalID)},_decreBtnHandle:function(a){if(a.options.orientation==="horizontal")a._decre();else a._incre()},_decreBtnClick:function(c){var a=c.data,b;a._decreBtnHandle(a);b={buttonType:"decreButton",value:a.value()};a._trigger("buttonclick",c,b)},_increBtnHandle:function(a){if(a.options.orientation==="horizontal")a._incre();else a._decre()},_increBtnClick:function(c){var a=c.data,b;a._increBtnHandle(a);b={buttonType:"increButton",value:a.value()};a._trigger("buttonclick",c,b)},_decre:function(){var a=this.value();if(!this.options.range&&!this.options.values){a=this.value();if(a<=this.options.min)this.value(this.options.min);else this.value(a-this.options.step)}else{a=this.values(0);if(a<=this.options.min)this.values(0,this.options.min);else this.values(0,a-this.options.step)}this.element.parent().attr("aria-valuenow",this.value())},_incre:function(){var a=this.value();if(!this.options.range&&!this.options.values){a=this.value();if(a>=this.options.max)this.value(this.options.max);else this.value(a+this.options.step)}else{a=this.values(1);if(a>=this.options.max)this.values(1,this.options.max);else this.values(1,a+this.options.step)}this.element.parent().attr("aria-valuenow",this.value())},_mouseInit:function(){var b=this;if(this.options.dragFill){this._preventClickEvent=false;this.element.bind("click",function(){if(b._dragFillStart>0)b._dragFillStart=0;else a.ui.slider.prototype._mouseCapture.apply(b,arguments)})}a.ui.mouse.prototype._mouseInit.apply(this,arguments)},_mouseCapture:function(b){this.element.parent().attr("aria-valuenow",this.value());if(this.options.dragFill)if(b.target.className==="ui-slider-range ui-widget-header"){this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();return true}else return a.ui.slider.prototype._mouseCapture.apply(this,arguments);else return a.ui.slider.prototype._mouseCapture.apply(this,arguments)},_dragFillTarget:false,_dragFillStart:0,_rangeValue:0,_oldValue1:0,_oldValue2:0,_oldX:0,_oldY:0,_mouseStart:function(a){if(this.options.dragFill){if(a.target)if(a.target.className==="ui-slider-range ui-widget-header"){this._dragFillTarget=true;this._rangeValue=this.values(1)-this.values(0);this._oldValue1=this.values(0);this._oldValue2=this.values(1);this._oldX=a.pageX;this._oldY=a.pageY;return true}this._dragFillTarget=false}return true},_mouseDrag:function(f){var d,c,e,b,g,h;if(this.options.dragFill){d=f.pageX-this._oldX;c=this.element.outerWidth();if(this.options.orientation==="vertical"){c=this.element.outerHeight();d=-(f.pageY-this._oldY)}e=(this.options.max-this.options.min)/c*d;if(this._dragFillTarget){if(this.options.orientation==="vertical")a(document.documentElement).css("cursor","s-resize");else a(document.documentElement).css("cursor","w-resize");if(this._dragFillStart>0){b=this._rangeValue;this.values(0,this._oldValue1+e);this.values(1,this._oldValue1+e+b);g=this.values(0);h=this.values(1);g+b>this.options.max&&this.values(0,this.options.max-b);h-b<this.options.min&&this.values(1,this.options.min+b)}this._dragFillStart++;return false}else return a.ui.slider.prototype._mouseDrag.apply(this,arguments)}else return a.ui.slider.prototype._mouseDrag.apply(this,arguments)},_mouseStop:function(){var b=a.ui.slider.prototype._mouseStop.apply(this,arguments);if(this.options.dragFill){a(document.documentElement).css("cursor","default");window.setTimeout(function(){this._dragFillTarget=false;this._dragFillStart=0},500)}return b}})})(jQuery);